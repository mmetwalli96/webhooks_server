/* define post request handlers here */

// import dependencies
const { Webhooks } = require('@octokit/webhooks');
require('dotenv').config();

module.exports = {
    eventHandler: async (req, res) => {
        const webhook = new Webhooks({
            secret: process.env.WEBHOOK_SECRET,
        });

	const payload = req.body;
	
	const signature = await webhook.sign(payload);
	
	const status = await webhook.verify(payload, signature)
	if (status) {
		const name = req.headers.accept["https://api.github.com/repos/mmetwalli96/AWS-S3/hooks
        	res.send('Well, it worked!');
        }
	else {
		res.send(401)
	}
    },
};
